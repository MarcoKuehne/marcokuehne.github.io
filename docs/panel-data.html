<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Panel Data | Becoming Fluent in Data</title>
  <meta name="description" content="A guide to become fluent in data." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Panel Data | Becoming Fluent in Data" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/warning.png" />
  <meta property="og:description" content="A guide to become fluent in data." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Panel Data | Becoming Fluent in Data" />
  
  <meta name="twitter:description" content="A guide to become fluent in data." />
  <meta name="twitter:image" content="/images/warning.png" />

<meta name="author" content="Marco Kühne" />


<meta name="date" content="2022-09-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/icons8-trading-64.ico" type="image/x-icon" />
<link rel="prev" href="mean-comparison.html"/>
<link rel="next" href="text-mining.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P9BQG7T00K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P9BQG7T00K');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://marcokuehne.github.io/">Becoming Fluent in Data</a></li> <li><p class="aligncenter"> <img src="images/icons8-trading-64.png"> </p></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Dust and Dark</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#content"><i class="fa fa-check"></i>Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#color"><i class="fa fa-check"></i>Color</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html"><i class="fa fa-check"></i>Intro to R</a>
<ul>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#watching-paint-dry"><i class="fa fa-check"></i>Watching paint dry</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#when-paint-becomes-art"><i class="fa fa-check"></i>When paint becomes art</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#define-objects"><i class="fa fa-check"></i>Define objects</a>
<ul>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#numeric-variables"><i class="fa fa-check"></i>Numeric Variables</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#logical-variables"><i class="fa fa-check"></i>Logical Variables</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#string-variables"><i class="fa fa-check"></i>String Variables</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#factor-variables"><i class="fa fa-check"></i>Factor Variables</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#combine-objects"><i class="fa fa-check"></i>Combine objects</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#data-frame"><i class="fa fa-check"></i>Data frame</a></li>
<li class="chapter" data-level="" data-path="intro-to-r.html"><a href="intro-to-r.html#plots"><i class="fa fa-check"></i>Plots</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data</b></span></li>
<li class="chapter" data-level="1" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html"><i class="fa fa-check"></i><b>1</b> Data is everywhere</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#why-we-measure"><i class="fa fa-check"></i><b>1.1</b> Why we measure</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#women-are-having-far-fewer-children."><i class="fa fa-check"></i><b>1.1.1</b> Women are having far fewer children.</a></li>
<li class="chapter" data-level="1.1.2" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#global-surface-temperature-is-rising."><i class="fa fa-check"></i><b>1.1.2</b> Global surface temperature is rising.</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#how-we-measure"><i class="fa fa-check"></i><b>1.2</b> How we measure</a></li>
<li class="chapter" data-level="1.3" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#types-of-data"><i class="fa fa-check"></i><b>1.3</b> Types of data</a></li>
<li class="chapter" data-level="1.4" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#the-reality-behind-the-data"><i class="fa fa-check"></i><b>1.4</b> The reality behind the data</a></li>
<li class="chapter" data-level="1.5" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#data-sources"><i class="fa fa-check"></i><b>1.5</b> Data sources</a></li>
<li class="chapter" data-level="1.6" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#dataset-collections"><i class="fa fa-check"></i><b>1.6</b> Dataset collections</a></li>
<li class="chapter" data-level="1.7" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#open-data"><i class="fa fa-check"></i><b>1.7</b> Open data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html"><i class="fa fa-check"></i><b>2</b> Software is everywhere</a>
<ul>
<li class="chapter" data-level="2.1" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#software"><i class="fa fa-check"></i><b>2.1</b> Software</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#command-line-interface-cli"><i class="fa fa-check"></i><b>2.1.1</b> Command line interface (CLI)</a></li>
<li class="chapter" data-level="2.1.2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#graphical-user-interface-gui"><i class="fa fa-check"></i><b>2.1.2</b> Graphical user interface (GUI)</a></li>
<li class="chapter" data-level="2.1.3" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#integrated-development-environment-ide"><i class="fa fa-check"></i><b>2.1.3</b> Integrated development environment (IDE)</a></li>
<li class="chapter" data-level="2.1.4" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#software-in-your-browser"><i class="fa fa-check"></i><b>2.1.4</b> Software in your browser</a></li>
<li class="chapter" data-level="2.1.5" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#software-in-the-cloud"><i class="fa fa-check"></i><b>2.1.5</b> Software in the cloud</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#file-formats"><i class="fa fa-check"></i><b>2.2</b> File formats</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#text-files"><i class="fa fa-check"></i><b>2.2.1</b> Text files</a></li>
<li class="chapter" data-level="2.2.2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#text-with-structure"><i class="fa fa-check"></i><b>2.2.2</b> Text with structure</a></li>
<li class="chapter" data-level="2.2.3" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#file-formats-1"><i class="fa fa-check"></i><b>2.2.3</b> File formats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="group-comparison.html"><a href="group-comparison.html"><i class="fa fa-check"></i><b>3</b> Group Comparison</a>
<ul>
<li class="chapter" data-level="3.1" data-path="group-comparison.html"><a href="group-comparison.html#story-telling"><i class="fa fa-check"></i><b>3.1</b> Story Telling</a></li>
<li class="chapter" data-level="3.2" data-path="group-comparison.html"><a href="group-comparison.html#comparability"><i class="fa fa-check"></i><b>3.2</b> Comparability</a></li>
<li class="chapter" data-level="3.3" data-path="group-comparison.html"><a href="group-comparison.html#never-use-pie-charts"><i class="fa fa-check"></i><b>3.3</b> Never use pie charts</a></li>
<li class="chapter" data-level="3.4" data-path="group-comparison.html"><a href="group-comparison.html#application"><i class="fa fa-check"></i><b>3.4</b> Application</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="group-comparison.html"><a href="group-comparison.html#loading-the-data"><i class="fa fa-check"></i><b>3.4.1</b> Loading the data</a></li>
<li class="chapter" data-level="3.4.2" data-path="group-comparison.html"><a href="group-comparison.html#look-into-data"><i class="fa fa-check"></i><b>3.4.2</b> Look into data</a></li>
<li class="chapter" data-level="3.4.3" data-path="group-comparison.html"><a href="group-comparison.html#fly-over-data"><i class="fa fa-check"></i><b>3.4.3</b> Fly over data</a></li>
<li class="chapter" data-level="3.4.4" data-path="group-comparison.html"><a href="group-comparison.html#missing-data"><i class="fa fa-check"></i><b>3.4.4</b> Missing data</a></li>
<li class="chapter" data-level="3.4.5" data-path="group-comparison.html"><a href="group-comparison.html#explore-data"><i class="fa fa-check"></i><b>3.4.5</b> Explore data</a></li>
<li class="chapter" data-level="3.4.6" data-path="group-comparison.html"><a href="group-comparison.html#standardization"><i class="fa fa-check"></i><b>3.4.6</b> Standardization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mean-comparison.html"><a href="mean-comparison.html"><i class="fa fa-check"></i><b>4</b> Mean Comparison</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mean-comparison.html"><a href="mean-comparison.html#application-1"><i class="fa fa-check"></i><b>4.1</b> Application</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="mean-comparison.html"><a href="mean-comparison.html#data-preparation"><i class="fa fa-check"></i><b>4.1.1</b> Data Preparation</a></li>
<li class="chapter" data-level="4.1.2" data-path="mean-comparison.html"><a href="mean-comparison.html#grouped-mean"><i class="fa fa-check"></i><b>4.1.2</b> Grouped Mean</a></li>
<li class="chapter" data-level="4.1.3" data-path="mean-comparison.html"><a href="mean-comparison.html#furious-with-factors"><i class="fa fa-check"></i><b>4.1.3</b> Furious with Factors</a></li>
<li class="chapter" data-level="4.1.4" data-path="mean-comparison.html"><a href="mean-comparison.html#plot-with-confidence"><i class="fa fa-check"></i><b>4.1.4</b> Plot with Confidence</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mean-comparison.html"><a href="mean-comparison.html#students-t-test"><i class="fa fa-check"></i><b>4.2</b> Student’s t-test</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="mean-comparison.html"><a href="mean-comparison.html#independent-t-test"><i class="fa fa-check"></i><b>4.2.1</b> Independent t-test</a></li>
<li class="chapter" data-level="4.2.2" data-path="mean-comparison.html"><a href="mean-comparison.html#dependent-t-test"><i class="fa fa-check"></i><b>4.2.2</b> Dependent t-test</a></li>
<li class="chapter" data-level="4.2.3" data-path="mean-comparison.html"><a href="mean-comparison.html#one-sample-t-test"><i class="fa fa-check"></i><b>4.2.3</b> One sample t-test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>5</b> Panel Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="panel-data.html"><a href="panel-data.html#unemployment"><i class="fa fa-check"></i><b>5.1</b> Unemployment</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="panel-data.html"><a href="panel-data.html#on-decline-in-germany"><i class="fa fa-check"></i><b>5.1.1</b> On decline in Germany</a></li>
<li class="chapter" data-level="5.1.2" data-path="panel-data.html"><a href="panel-data.html#measurement"><i class="fa fa-check"></i><b>5.1.2</b> Measurement</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="panel-data.html"><a href="panel-data.html#application-2"><i class="fa fa-check"></i><b>5.2</b> Application</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="panel-data.html"><a href="panel-data.html#data-inspection"><i class="fa fa-check"></i><b>5.2.1</b> Data Inspection</a></li>
<li class="chapter" data-level="5.2.2" data-path="panel-data.html"><a href="panel-data.html#data-preparation-1"><i class="fa fa-check"></i><b>5.2.2</b> Data Preparation</a></li>
<li class="chapter" data-level="5.2.3" data-path="panel-data.html"><a href="panel-data.html#data-visualization"><i class="fa fa-check"></i><b>5.2.3</b> Data Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>6</b> Text Mining</a>
<ul>
<li class="chapter" data-level="6.1" data-path="text-mining.html"><a href="text-mining.html#learning-goals"><i class="fa fa-check"></i><b>6.1</b> Learning Goals</a></li>
<li class="chapter" data-level="6.2" data-path="text-mining.html"><a href="text-mining.html#get-text"><i class="fa fa-check"></i><b>6.2</b> Get Text</a></li>
<li class="chapter" data-level="6.3" data-path="text-mining.html"><a href="text-mining.html#translate-everything-to-english"><i class="fa fa-check"></i><b>6.3</b> Translate Everything To English</a></li>
<li class="chapter" data-level="6.4" data-path="text-mining.html"><a href="text-mining.html#text-analysis"><i class="fa fa-check"></i><b>6.4</b> Text Analysis</a></li>
<li class="chapter" data-level="6.5" data-path="text-mining.html"><a href="text-mining.html#little-bit-of-scraping"><i class="fa fa-check"></i><b>6.5</b> Little bit of Scraping</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="relationships.html"><a href="relationships.html"><i class="fa fa-check"></i><b>7</b> Relationships</a>
<ul>
<li class="chapter" data-level="7.1" data-path="relationships.html"><a href="relationships.html#minimal-example"><i class="fa fa-check"></i><b>7.1</b> Minimal Example</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="relationships.html"><a href="relationships.html#variance"><i class="fa fa-check"></i><b>7.1.1</b> Variance</a></li>
<li class="chapter" data-level="7.1.2" data-path="relationships.html"><a href="relationships.html#variation-around-the-mean"><i class="fa fa-check"></i><b>7.1.2</b> Variation ARound the Mean</a></li>
<li class="chapter" data-level="7.1.3" data-path="relationships.html"><a href="relationships.html#scatterplot"><i class="fa fa-check"></i><b>7.1.3</b> Scatterplot</a></li>
<li class="chapter" data-level="7.1.4" data-path="relationships.html"><a href="relationships.html#covariance"><i class="fa fa-check"></i><b>7.1.4</b> Covariance</a></li>
<li class="chapter" data-level="7.1.5" data-path="relationships.html"><a href="relationships.html#covariance-visualization"><i class="fa fa-check"></i><b>7.1.5</b> Covariance Visualization</a></li>
<li class="chapter" data-level="7.1.6" data-path="relationships.html"><a href="relationships.html#correlation"><i class="fa fa-check"></i><b>7.1.6</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="relationships.html"><a href="relationships.html#application-3"><i class="fa fa-check"></i><b>7.2</b> Application</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="relationships.html"><a href="relationships.html#one-variable-graphics"><i class="fa fa-check"></i><b>7.2.1</b> One Variable Graphics</a></li>
<li class="chapter" data-level="7.2.2" data-path="relationships.html"><a href="relationships.html#two-variable-graphics"><i class="fa fa-check"></i><b>7.2.2</b> Two Variable Graphics</a></li>
<li class="chapter" data-level="7.2.3" data-path="relationships.html"><a href="relationships.html#correlation-and-regression"><i class="fa fa-check"></i><b>7.2.3</b> Correlation and Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>8</b> Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression.html"><a href="regression.html#from-artists-and-economists"><i class="fa fa-check"></i><b>8.1</b> From Artists and Economists</a></li>
<li class="chapter" data-level="8.2" data-path="regression.html"><a href="regression.html#data-is-everywhere-1"><i class="fa fa-check"></i><b>8.2</b> Data is everywhere</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="regression.html"><a href="regression.html#data-in-a-table"><i class="fa fa-check"></i><b>8.2.1</b> Data in a table</a></li>
<li class="chapter" data-level="8.2.2" data-path="regression.html"><a href="regression.html#data-in-a-graph"><i class="fa fa-check"></i><b>8.2.2</b> Data in a graph</a></li>
<li class="chapter" data-level="8.2.3" data-path="regression.html"><a href="regression.html#the-trend"><i class="fa fa-check"></i><b>8.2.3</b> The trend</a></li>
<li class="chapter" data-level="8.2.4" data-path="regression.html"><a href="regression.html#the-blackbox"><i class="fa fa-check"></i><b>8.2.4</b> The blackbox</a></li>
<li class="chapter" data-level="8.2.5" data-path="regression.html"><a href="regression.html#nobodys-perfect"><i class="fa fa-check"></i><b>8.2.5</b> Nobody’s perfect</a></li>
<li class="chapter" data-level="8.2.6" data-path="regression.html"><a href="regression.html#vocab-wrap-up"><i class="fa fa-check"></i><b>8.2.6</b> Vocab Wrap-Up</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="regression.html"><a href="regression.html#for-the-truly-dedicated"><i class="fa fa-check"></i><b>8.3</b> For the truly dedicated</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="regression.html"><a href="regression.html#algebra"><i class="fa fa-check"></i><b>8.3.1</b> Algebra</a></li>
<li class="chapter" data-level="8.3.2" data-path="regression.html"><a href="regression.html#analysis"><i class="fa fa-check"></i><b>8.3.2</b> Analysis</a></li>
<li class="chapter" data-level="8.3.3" data-path="regression.html"><a href="regression.html#take-the-long-way-home"><i class="fa fa-check"></i><b>8.3.3</b> Take the Long Way Home</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regression.html"><a href="regression.html#survival-of-the-fittest-line"><i class="fa fa-check"></i><b>8.4</b> Survival of the Fittest Line</a></li>
<li class="chapter" data-level="8.5" data-path="regression.html"><a href="regression.html#on-the-shoulders-of-giants"><i class="fa fa-check"></i><b>8.5</b> On the Shoulders of Giants</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>9</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#minimal-example-1"><i class="fa fa-check"></i><b>9.1</b> Minimal Example</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#think-inside-of-a-box"><i class="fa fa-check"></i><b>9.1.1</b> Think inside of a box</a></li>
<li class="chapter" data-level="9.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#from-probability-to-odds"><i class="fa fa-check"></i><b>9.1.2</b> From probability to odds</a></li>
<li class="chapter" data-level="9.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#from-odds-to-log-of-odds"><i class="fa fa-check"></i><b>9.1.3</b> From odds to log of odds</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#application-titanic-survival"><i class="fa fa-check"></i><b>9.2</b> Application: Titanic Survival</a></li>
<li class="chapter" data-level="9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#addons"><i class="fa fa-check"></i><b>9.3</b> Addons</a></li>
<li class="chapter" data-level="9.4" data-path="logistic-regression.html"><a href="logistic-regression.html#motivation"><i class="fa fa-check"></i><b>9.4</b> Motivation</a></li>
<li class="chapter" data-level="9.5" data-path="logistic-regression.html"><a href="logistic-regression.html#load-and-merge"><i class="fa fa-check"></i><b>9.5</b> Load and Merge</a></li>
<li class="chapter" data-level="9.6" data-path="logistic-regression.html"><a href="logistic-regression.html#data-manipulation"><i class="fa fa-check"></i><b>9.6</b> Data Manipulation</a></li>
<li class="chapter" data-level="9.7" data-path="logistic-regression.html"><a href="logistic-regression.html#simple-linear-model"><i class="fa fa-check"></i><b>9.7</b> Simple linear model</a></li>
<li class="chapter" data-level="9.8" data-path="logistic-regression.html"><a href="logistic-regression.html#multiple-regression-with-control"><i class="fa fa-check"></i><b>9.8</b> Multiple regression with control</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="logistic-regression.html"><a href="logistic-regression.html#regression-model"><i class="fa fa-check"></i><b>9.8.1</b> Regression model</a></li>
<li class="chapter" data-level="9.8.2" data-path="logistic-regression.html"><a href="logistic-regression.html#visualization-parallel-slopes"><i class="fa fa-check"></i><b>9.8.2</b> Visualization (parallel slopes)</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="logistic-regression.html"><a href="logistic-regression.html#multiple-regression-with-moderator"><i class="fa fa-check"></i><b>9.9</b> Multiple regression with moderator</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-dummy-dummy"><i class="fa fa-check"></i><b>9.9.1</b> Interaction (dummy * dummy)</a></li>
<li class="chapter" data-level="9.9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-categorical-dummy"><i class="fa fa-check"></i><b>9.9.2</b> Interaction (categorical * dummy)</a></li>
<li class="chapter" data-level="9.9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-continuous-dummy"><i class="fa fa-check"></i><b>9.9.3</b> Interaction (continuous * dummy)</a></li>
<li class="chapter" data-level="9.9.4" data-path="logistic-regression.html"><a href="logistic-regression.html#visualization-non-parallel-slopes"><i class="fa fa-check"></i><b>9.9.4</b> Visualization (non-parallel slopes)</a></li>
<li class="chapter" data-level="9.9.5" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-continuous-continuous"><i class="fa fa-check"></i><b>9.9.5</b> Interaction (continuous * continuous)</a></li>
<li class="chapter" data-level="9.9.6" data-path="logistic-regression.html"><a href="logistic-regression.html#visualization-non-parallel-slopes-1"><i class="fa fa-check"></i><b>9.9.6</b> Visualization (non-parallel slopes)</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="logistic-regression.html"><a href="logistic-regression.html#marginal-effects-1"><i class="fa fa-check"></i><b>9.10</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#marginal-effects-at-representatives-task"><i class="fa fa-check"></i><b>9.10.1</b> Marginal effects at representatives (TASK)</a></li>
<li class="chapter" data-level="9.10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#marginal-effects-at-the-mean-task"><i class="fa fa-check"></i><b>9.10.2</b> Marginal effects at the mean (TASK)</a></li>
<li class="chapter" data-level="9.10.3" data-path="logistic-regression.html"><a href="logistic-regression.html#average-marginal-effects"><i class="fa fa-check"></i><b>9.10.3</b> Average marginal effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fixed-effects.html"><a href="fixed-effects.html"><i class="fa fa-check"></i><b>10</b> Fixed effects</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fixed-effects.html"><a href="fixed-effects.html#cross-sectional-data-2-pt"><i class="fa fa-check"></i><b>10.1</b> Cross-sectional Data (2 pt)</a></li>
<li class="chapter" data-level="10.2" data-path="fixed-effects.html"><a href="fixed-effects.html#panel-data-2-pt"><i class="fa fa-check"></i><b>10.2</b> Panel Data (2 pt)</a></li>
<li class="chapter" data-level="10.3" data-path="fixed-effects.html"><a href="fixed-effects.html#fixed-effects-regression"><i class="fa fa-check"></i><b>10.3</b> Fixed Effects Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="fixed-effects.html"><a href="fixed-effects.html#first-difference-2-pt"><i class="fa fa-check"></i><b>10.3.1</b> First Difference (2 pt)</a></li>
<li class="chapter" data-level="10.3.2" data-path="fixed-effects.html"><a href="fixed-effects.html#within-estimator-2-pt"><i class="fa fa-check"></i><b>10.3.2</b> Within Estimator (2 pt)</a></li>
<li class="chapter" data-level="10.3.3" data-path="fixed-effects.html"><a href="fixed-effects.html#lsdv-1-pt"><i class="fa fa-check"></i><b>10.3.3</b> LSDV (1 pt)</a></li>
<li class="chapter" data-level="10.3.4" data-path="fixed-effects.html"><a href="fixed-effects.html#comparison-1-pt"><i class="fa fa-check"></i><b>10.3.4</b> Comparison (1 pt)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="first-difference.html"><a href="first-difference.html"><i class="fa fa-check"></i><b>11</b> First Difference</a>
<ul>
<li class="chapter" data-level="11.1" data-path="first-difference.html"><a href="first-difference.html#application-mincer-earnings-function"><i class="fa fa-check"></i><b>11.1</b> Application: Mincer earnings function</a></li>
<li class="chapter" data-level="11.2" data-path="first-difference.html"><a href="first-difference.html#data-management-4-pt"><i class="fa fa-check"></i><b>11.2</b> Data Management (4 pt)</a></li>
<li class="chapter" data-level="11.3" data-path="first-difference.html"><a href="first-difference.html#data-visualization-2-pt"><i class="fa fa-check"></i><b>11.3</b> Data Visualization (2 pt)</a></li>
<li class="chapter" data-level="11.4" data-path="first-difference.html"><a href="first-difference.html#data-modeling-2-pt"><i class="fa fa-check"></i><b>11.4</b> Data Modeling (2 pt)</a></li>
<li class="chapter" data-level="11.5" data-path="first-difference.html"><a href="first-difference.html#minimal-example-2"><i class="fa fa-check"></i><b>11.5</b> Minimal Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://marco-kuehne.com/" target="blank">Visit my personal page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Becoming Fluent in Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = infobox>
This book is <b>Work in Progress</b>. I appreciate your feedback to make the book better.
</div>
<div id="panel-data" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Panel Data<a href="panel-data.html#panel-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Learning Goals</strong></p>
<div class="defox">
<ul>
<li>Conceptual Skills:
<ul>
<li>Understand panel data. Panel attrition.</li>
<li>Distinguish between and within variation.</li>
<li>Compare the paired and unpaired t-Test to panel data.</li>
</ul></li>
<li>Data Skills:
<ul>
<li>How <code>set.seed()</code> defeats randomness.<br />
</li>
<li>Find and use <em>functions</em> from other people.</li>
<li>Tidyverse e.g. <code>group_by()</code>, <code>sample_n()</code>, <code>summarize()</code>, <code>count()</code>, <code>arrange()</code>.</li>
<li>Data Visualization: Panel plots (time series per group).</li>
</ul></li>
</ul>
</div>
<hr />
<p>Panel data are observations for the same subjects over time. Subjects can be people, households, firms or countries. Panel data are a subset of longitudinal data. Key components are the panel identifier: person (id) and time (year). Every row is a person-year combination (so called <em>long format</em>).</p>
<!-- ::: {.infobox2 .information data-latex="warning"} -->
<!-- Compare these types of data: -->
<!-- -   *Cross-section*: One time measurement. -->
<!-- -   *Repeated cross-section*: Different people. -->
<!-- -   *Panel*: Repeated observations of the same individuals. -->
<!-- ::: -->
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<!-- ```{r, echo=FALSE, out.width="70%", fig.cap="\\label{fig:wb}Table 1: Types of Data.", fig.align='center'} -->
<!-- knitr::include_graphics("images/paneldata.png") -->
<!-- ``` -->
<p>With panel data we know the time-ordering of events. Panel data allow to identify causal effects under weaker assumptions (compared to cross-sectional data). Especially, panel data allows for certain statistical analyses, e.g. <a href="fixed-effects.html#fixed-effects">fixed effects regression</a>. Different types of data can answer different types of questions:</p>
<ul>
<li>Levels: How many people are poor in 2016 in Germany?</li>
<li>Trends: Has poverty increased or decreased?</li>
<li>Change: How many people went in and out of poverty?</li>
</ul>
<p>Famous household panel data studies include:</p>
<ul>
<li>United States: Panel Study of Income Dynamics (PSID) since 1968</li>
<li>Germany: Socio-Economic Panel (SOEP) since 1984</li>
<li>United Kingdom: British Household Panel Survey (BHPS) since 1991</li>
<li>Australia: Household, Income and Labour Dynamics in Australia Survey (HILDA) since 2001</li>
</ul>
<p>These scientific datasets can often be analyzed for research and student theses free of charge.</p>
<div id="unemployment" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Unemployment<a href="panel-data.html#unemployment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unemployment occurs when someone is willing and able to work but does not have a paid job. Unemployment is measured by the unemployment rate. The unemployment rate is the most commonly used indicator for understanding conditions in the labour market.</p>
<blockquote>
<p>The personal and social costs of unemployment include severe financial hardship and poverty, debt, homelessness and housing stress, family tensions and breakdown, boredom, alienation, shame and stigma, increased social isolation, crime, erosion of confidence and self-esteem, the atrophying of work skills and ill-health.</b></p>
<footer>
<span class="citation">McClelland and Macdonald (<a href="references.html#ref-mcclelland1998social" role="doc-biblioref">1998</a>)</span>
</footer>
</blockquote>
<div id="on-decline-in-germany" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> On decline in Germany<a href="panel-data.html#on-decline-in-germany" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-4-1.png" alt="Unemployment rate in Germany" width="672" />
<p class="caption">
Figure 5.1: Unemployment rate in Germany
</p>
</div>
<div class="reading">
<p><strong>How low can the unemployment rate be?</strong></p>
<p><em>“Here are two things most economists can agree upon: They want an economy where everyone who seeks a job can get one. Yet for the economy to be dynamic, some people will always be unemployed, at least temporarily as they move between jobs.”</em></p>
<p><a href="https://www.nytimes.com/2018/02/28/upshot/how-low-can-unemployment-really-go-economists-have-no-idea.html">How Low Can Unemployment Really Go? Economists Have No Idea</a></p>
</div>
<details>
<summary>
<em>Life after collage.</em>
</summary>
<img src="images/lifeaftercollege.png" title="Life After Collage" width="350" />
</details>
<!-- The unemployment rate in Germany is about 5 \% over the last few years (Source: [Annual average unemployment rate in Germany from 2005 to 2022 ](https://www.statista.com/statistics/227005/unemployment-rate-in-germany/)). How bad is 5 \%? -->
<!-- ::: {.defbox} -->
<!-- Imagine a college graduate from Viadrina Frankfurt (Oder) enters the job market. It takes about 3 month to search for jobs, send applications and do the job interviews. Finally she finds a perfect match. After some years the college graduate falls in love with someone who lives in Buxtehude, so the graduate moves to this place, again looking for a job at a new employer.  -->
<!-- Imagine, after some years the collage graduate falls in love with someone who lives in another city, so the student moves to this city for personal reasons, again looking for a new job. Do you think that is a cause for concern?  -->
<!-- Imagine another college graduate. He sends 5 applications for various jobs per week. He has several mini jobs to keep afloat. The student realizes that he did not acquire the skills that are expected on the job market. After 2 years, he finally finds a suitable position. -->
<!-- Do you think that is a cause for concern? -->
<!-- ::: -->
<p><br></p>
<p>Panel data allows to analyze the level of unemployment in Germany as well as the changes and trajectories of individuals. We can separate a <em>frictional unemployment</em> component and a <em>permanent unemployment</em> share. Frictional unemployment is a form of unemployment reflecting the gap between someone voluntarily leaving a job and finding another. As such, it is sometimes called search unemployment. Is search unemployment acceptable? Is it different from long-term unemployment? What do you think.</p>
</div>
<div id="measurement" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Measurement<a href="panel-data.html#measurement" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>unemployment rate</strong> represents the proportion of the <strong>civilian labour force</strong> that is unemployed. Consequently, measuring the unemployment rate requires identifying who is in the labour force. The labour force consists of all employed and unemployed persons of working age.</p>
<div class="reading">
<p><strong>How low can the unemployment rate be?</strong></p>
<p><em>“Here are two things most economists can agree upon: They want an economy where everyone who seeks a job can get one. Yet for the economy to be dynamic, some people will always be unemployed, at least temporarily as they move between jobs.”</em></p>
<p><a href="https://www.rba.gov.au/education/resources/explainers/unemployment-its-measurement-and-types.html">Unemployment: Its Measurement and Types</a></p>
</div>
</div>
</div>
<div id="application-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Application<a href="panel-data.html#application-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-inspection" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Data Inspection<a href="panel-data.html#data-inspection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load SOEP practice data comes labeled and ready for analysis.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="panel-data.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="panel-data.html#cb1-2" aria-hidden="true" tabindex="-1"></a>soep <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;https://github.com/MarcoKuehne/marcokuehne.github.io/blob/main/data/practice_dataset_eng.dta?raw=true&quot;</span>)</span></code></pre></div>
<p><code>group_by()</code> is a powerful command, especially when working with panel data. Use <code>count()</code> after <code>group_by()</code> to get the number of observations of each person (<code>id</code>) in the data. When wrapped with <code>head()</code> it display the first six observations.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="panel-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="panel-data.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(soep <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">count</span>())</span></code></pre></div>
<details>
<summary>
<em>See result.</em>
</summary>
<pre><code>## # A tibble: 6 × 2
## # Groups:   id [6]
##      id     n
##   &lt;dbl&gt; &lt;int&gt;
## 1     4     5
## 2     8     5
## 3    15     5
## 4    17     5
## 5    28     5
## 6    29     5</code></pre>
</details>
<p>Adding <code>arrange()</code> means sorting the data by a variable (i.e. the temporarily created variable <code>n</code>) either ascending or descending (from high to low). Ascending is the default. For descending order apply the <code>desc()</code> command.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="panel-data.html#cb4-1" aria-hidden="true" tabindex="-1"></a>soep <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) </span></code></pre></div>
<details>
<summary>
<em>See result.</em>
</summary>
<pre><code>## # A tibble: 6,355 × 2
## # Groups:   id [6,355]
##       id     n
##    &lt;dbl&gt; &lt;int&gt;
##  1     4     5
##  2     8     5
##  3    15     5
##  4    17     5
##  5    28     5
##  6    29     5
##  7    53     5
##  8    56     5
##  9    71     5
## 10    85     5
## # … with 6,345 more rows</code></pre>
Note that the output further tells you <code># A tibble: 3,550 x 2</code>, i.e. there are 3550 ID-groups (or units or people).
</details>
<p>Remember that the observation period is between 2015 and 2019, i.e. the minimum number of observations per individual is 1 year, the maximum is 5 years. Over the years, observations get less and less.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="panel-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(soep<span class="sc">$</span>syear)</span></code></pre></div>
<pre><code>## 
## 2015 2016 2017 2018 2019 
## 5527 4987 4720 4351 3937</code></pre>
<div class="defbox">
<p><strong>Attrition</strong> is the process of dropout from a panel study.</p>
</div>
<p>How many people are observed in all years? Filter for a specific n and ask for the number of rows or observations (alternatively you can check the tibble size again).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="panel-data.html#cb8-1" aria-hidden="true" tabindex="-1"></a>soep <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code></pre></div>
<p><code>erwerb</code> is the employment status in SOEP. Its labels range from -7 to 6. Use the <code>attributes()</code> command on a specific variable. It returns a set of information (object class is <code>list</code>). We can access elements of this list by the <code>$</code> operator. Did you notice the small mistake in the labels? (Remember this is practice data.)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="panel-data.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(soep<span class="sc">$</span>erwerb)<span class="sc">$</span>labels</span></code></pre></div>
<details>
<summary>
<em>See result.</em>
</summary>
<pre><code>##         [-7] Only available in less restricted edition 
##                                                     -7 
##  [-6] Version of questionnaire with modified filtering 
##                                                     -6 
## [-5] Not included in this version of the questionnaire 
##                                                     -5 
##                    [-4] Inadmissable multiple response 
##                                                     -4 
##                                         [-3] not valid 
##                                                     -3 
##                                    [-2] does not apply 
##                                                     -2 
##                                         [-1] no answer 
##                                                     -1 
##                                [-1] Employed full-time 
##                                                      1 
##                                [-2] Employed part-time 
##                                                      2 
##                           [3] Training, apprenticeship 
##                                                      3 
##                [4] Irregular employment or in marginal 
##                                                      4 
##                                       [5] Not employed 
##                                                      5 
##                         [6] Garage for disabled people 
##                                                      6</code></pre>
Note that the output further tells you <code># A tibble: 3,550 x 2</code>, i.e. there are 3550 ID-groups (or units or people).
</details>
<p>Negative values indicate several different form of missing data in SOEP. <a href="http://companion.soep.de/Data%20Structure%20of%20SOEPcore/Missing%20Conventions.html">Read more on missing conventions</a> Actually, there are no negative values in this dataset. As for levels of a factor variables, labels can be empty.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="panel-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(soep<span class="sc">$</span>erwerb)</span></code></pre></div>
<pre><code>## 
##    1    2    3    4    5    6 
## 8700 3481  695 1446 9169   29</code></pre>
</div>
<div id="data-preparation-1" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Data Preparation<a href="panel-data.html#data-preparation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We drop small categories with the <code>filter()</code> command. Apply the <code>%in%</code> operator to search for values in a vector. Overwrite the existing data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="panel-data.html#cb13-1" aria-hidden="true" tabindex="-1"></a>soep <span class="ot">&lt;-</span> soep <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="panel-data.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(erwerb <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>We summarize categories with a combination of <code>mutatae()</code> and <code>case_when()</code>. For each value in <code>erwerb</code> conduct a logical comparison via <code>==</code> and assign a new value. In this case it combines <em>Employed part-time</em> with <em>Irregular employment or in marginal</em>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="panel-data.html#cb14-1" aria-hidden="true" tabindex="-1"></a>soep <span class="ot">&lt;-</span> soep <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="panel-data.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">erwerb =</span> <span class="fu">case_when</span>(erwerb <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;fulltime&quot;</span>,</span>
<span id="cb14-3"><a href="panel-data.html#cb14-3" aria-hidden="true" tabindex="-1"></a>                            erwerb <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;partime&quot;</span>, </span>
<span id="cb14-4"><a href="panel-data.html#cb14-4" aria-hidden="true" tabindex="-1"></a>                            erwerb <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;partime&quot;</span>,</span>
<span id="cb14-5"><a href="panel-data.html#cb14-5" aria-hidden="true" tabindex="-1"></a>                            erwerb <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">&quot;unemployed&quot;</span>,</span>
<span id="cb14-6"><a href="panel-data.html#cb14-6" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;NA&quot;</span>))</span></code></pre></div>
<p>The unemployment rate represents the proportion of the civilian labour force that is unemployed. The labour force consists of all employed and unemployed persons of working age. Filter for working age between 18 and 65 years.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="panel-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a>soep <span class="ot">&lt;-</span> soep <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="panel-data.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(alter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">18</span><span class="sc">:</span><span class="dv">65</span>))</span></code></pre></div>
<p><code>group_by()</code> accepts multiple inputs. The following combination returns for each year and each employment status the number of observations.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="panel-data.html#cb16-1" aria-hidden="true" tabindex="-1"></a>soep <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="panel-data.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(syear, erwerb) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="panel-data.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;syear&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre><code>## # A tibble: 15 × 3
## # Groups:   syear [5]
##    syear erwerb         n
##    &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt;
##  1  2015 fulltime    2007
##  2  2015 partime     1084
##  3  2015 unemployed  1163
##  4  2016 fulltime    1798
##  5  2016 partime      964
##  6  2016 unemployed   969
##  7  2017 fulltime    1736
##  8  2017 partime      895
##  9  2017 unemployed   893
## 10  2018 fulltime    1612
## 11  2018 partime      850
## 12  2018 unemployed   776
## 13  2019 fulltime    1465
## 14  2019 partime      778
## 15  2019 unemployed   643</code></pre>
<p>Having done this, step back to focus on years again and use different n-values per year to figure out the unemployment. Relate <code>unemployed</code> to those working either <code>fulltime</code> or <code>partime</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="panel-data.html#cb19-1" aria-hidden="true" tabindex="-1"></a>soep <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="panel-data.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(syear, erwerb) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="panel-data.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="panel-data.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(syear) <span class="sc">%&gt;%</span> </span>
<span id="cb19-5"><a href="panel-data.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unemployment_rate =</span> n[<span class="dv">3</span>]<span class="sc">/</span>(n[<span class="dv">1</span>]<span class="sc">+</span>n[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;syear&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre><code>## # A tibble: 15 × 4
## # Groups:   syear [5]
##    syear erwerb         n unemployment_rate
##    &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt;             &lt;dbl&gt;
##  1  2015 fulltime    2007             0.376
##  2  2015 partime     1084             0.376
##  3  2015 unemployed  1163             0.376
##  4  2016 fulltime    1798             0.351
##  5  2016 partime      964             0.351
##  6  2016 unemployed   969             0.351
##  7  2017 fulltime    1736             0.339
##  8  2017 partime      895             0.339
##  9  2017 unemployed   893             0.339
## 10  2018 fulltime    1612             0.315
## 11  2018 partime      850             0.315
## 12  2018 unemployed   776             0.315
## 13  2019 fulltime    1465             0.287
## 14  2019 partime      778             0.287
## 15  2019 unemployed   643             0.287</code></pre>
</div>
<div id="data-visualization" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Data Visualization<a href="panel-data.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="panel-data.html#cb22-1" aria-hidden="true" tabindex="-1"></a>soep <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="panel-data.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(syear, erwerb) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="panel-data.html#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="panel-data.html#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(syear) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="panel-data.html#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unemployment_rate =</span> n[<span class="dv">3</span>]<span class="sc">/</span>(n[<span class="dv">1</span>]<span class="sc">+</span>n[<span class="dv">2</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="panel-data.html#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> syear, <span class="at">y =</span> unemployment_rate)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;syear&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div id="obs-per-group" class="section level4 hasAnchor" number="5.2.3.1">
<h4><span class="header-section-number">5.2.3.1</span> Obs per group<a href="panel-data.html#obs-per-group" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="panel-data.html#cb24-1" aria-hidden="true" tabindex="-1"></a>soep <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="panel-data.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="panel-data.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="panel-data.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="panel-data.html#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of observations per individual&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="panel-data.html#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="unemployment-1" class="section level4 hasAnchor" number="5.2.3.2">
<h4><span class="header-section-number">5.2.3.2</span> Unemployment<a href="panel-data.html#unemployment-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="panel-data.html#cb25-1" aria-hidden="true" tabindex="-1"></a>soep<span class="sc">$</span>erwerb</span>
<span id="cb25-2"><a href="panel-data.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="panel-data.html#cb25-3" aria-hidden="true" tabindex="-1"></a>soep <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="panel-data.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="panel-data.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="panel-data.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="panel-data.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of observations per individual&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="panel-data.html#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<!-- ### Average Health per Year  -->
<!-- A picture is worth a thousand words. Show a time trend or a relationship at the beginning of your analysis. People fancy plots. Your plot should be interesting and easy to understand. If you think obesity or crime is a problem for society and it's increasing over time you made a good point of why we should talk about it or analyze it more thoroughly. Actually, after months and years of empirical research, the results often can be summarized in one single plot.  -->
<!-- ```{r warning=FALSE, message=FALSE, echo=FALSE, eval=TRUE} -->
<!-- soep %>%  -->
<!--   group_by(year) %>% -->
<!--   filter(!is.na(health_org)) %>% -->
<!--   summarize(health_mean = mean(health_org)) %>% -->
<!--   ggplot(aes(x = year, y = health_mean)) +  # plot satisfaction versus year colored by person -->
<!--   geom_line() + geom_point() + # add points connected by lines -->
<!--   labs(title="Population health over time",  -->
<!--        subtitle="Mean Health Status in Germany between 2000 and 2004", -->
<!--        x="Year", y="Health Status") + # give some illustrative labels -->
<!--   ylim(1,5) # limit the scale always to all possible values, to prevent random misperceptions  -->
<!-- ``` -->
<!-- Health status in Germany is stable.  -->
<!-- ### Individual Health per Year  -->
<!-- <!-- ::: {.infobox2 .information data-latex="warning"} -->
<p>–&gt;
<!-- <!-- **Critical life events** (e.g. birth of a child, death of a loved one, suddenly becoming unemployed, winning the lottery) can have a dramatic effect on life satisfaction. Some events can be anticipated (e.g. birth or marriage). After the event adaptation might follow.  --> –&gt;
<!-- <!-- ::: --> –&gt;</p>
<!-- Next, we dig deeper into personal health stories.  -->
<!-- <!-- ```{r warning=FALSE, message=FALSE, echo=TRUE, eval=FALSE} -->
<p>–&gt;
<!-- <!-- soep %>%  --> –&gt;
<!-- <!--   filter(id < 10000) %>% # better filter for some IDs here, otherwise R crashes  --> –&gt;
<!-- <!--   ggplot(aes(x = year, y = health_org, group=as_factor(id), color=as_factor(id))) +   --> –&gt;
<!-- <!--   geom_line() + geom_point() + --> –&gt;
<!-- <!--   labs(title="Health status per Person",  --> –&gt;
<!-- <!--        x="Year", y="Health Status") +  --> –&gt;
<!-- <!--   ylim(1,5)  --> –&gt;
<!-- <!-- ``` --> –&gt;</p>
<!-- <!-- <details> -->
<p>–&gt;
<!-- <!-- <summary> --> –&gt;
<!-- <!-- *Show me the mess.* --> –&gt;
<!-- <!-- </summary> --> –&gt;
<!-- <!-- ```{r warning=FALSE, message=FALSE, echo=FALSE, eval=TRUE} --> –&gt;
<!-- <!-- soep %>%  --> –&gt;
<!-- <!--   filter(id < 10000) %>% # better filter for some IDs here, otherwise R crashes  --> –&gt;
<!-- <!--   ggplot(aes(x = year, y = satisf_org, group=as_factor(id), color=as_factor(id))) +   --> –&gt;
<!-- <!--   geom_line() + geom_point() + --> –&gt;
<!-- <!--   labs(title="Life satisfaction per Person",  --> –&gt;
<!-- <!--        x="Year", y="Life Satisfaction") +  --> –&gt;
<!-- <!--   ylim(0,10)  --> –&gt;
<!-- <!-- ``` --> –&gt;
<!-- <!-- </details> --> –&gt;</p>
<!-- <!-- Most observations are in the upper half. No one reports life satisfaction of 0 or 1. Still, this looks messy. Coloring and labeling groups does not help. Single lines cannot be distinguished. If we are interested in individual fate we need to filter for less units.  -->
<p>–&gt;</p>
<!-- <!-- <details> -->
<p>–&gt;
<!-- <!-- <summary> --> –&gt;
<!-- <!-- *See the filter for id < 1000 * --> –&gt;
<!-- <!-- </summary> --> –&gt;
<!-- <!-- ```{r warning=FALSE, message=FALSE, echo=TRUE} --> –&gt;
<!-- <!-- soep %>%  --> –&gt;
<!-- <!--   filter(id < 1000) %>% # better filter for some IDs otherwise R crashes  --> –&gt;
<!-- <!--   ggplot(aes(x = year, y = satisf_org, group=as_factor(id), color=as_factor(id))) +   --> –&gt;
<!-- <!--   geom_line() + geom_point() + --> –&gt;
<!-- <!--   labs(title="Life satisfaction per Person",  --> –&gt;
<!-- <!--        x="Year", y="Life Satisfaction") +  --> –&gt;
<!-- <!--   ylim(0,10)  --> –&gt;
<!-- <!-- ``` --> –&gt;</p>
<!-- <!-- Note that **several people are observed only once or twice**. If we are interested in critical life events we require information before and after an event (e.g. birth of children). Furthermore, panel estimations require at least two observations (which we will learn at the end of the course).  -->
<p>–&gt;
<!-- <!-- </details> --> –&gt;</p>
<!-- #### Random Panel Sample -->
<!-- Let's use `sample_n()` for random selection of observations. Each time this command is run, a different random set of observations is drawn. Note that these 5 random observations/rows do not stem from the same people. -->
<!-- ```{r warning=FALSE, message=FALSE} -->
<!-- soep %>% sample_n(5)  -->
<!-- ``` -->
<!-- If you plant a seed with `set.seed` randomness becomes reproducible.  -->
<!-- ```{r warning=FALSE, message=FALSE} -->
<!-- set.seed(42) -->
<!-- soep %>% sample_n(5)  -->
<!-- ``` -->
<!-- #### Personalize Functions  -->
<!-- Is there a `sample_n_groups` command in the tidyverse? Unfortunately not. Even in such a case, it's unlikely that you need to invent something new. One of the first Google hits is: <https://cmdlinetips.com/2019/07/how-to-randomly-select-groups-in-r-with-dplyr/> and they suggest: -->
<!-- ```{r, eval=TRUE, echo=TRUE, message=FALSE, warning=FALSE} -->
<!-- sample_n_groups = function(grouped_df, size, replace = FALSE, weight=NULL) { -->
<!--   grp_var <- grouped_df %>%  -->
<!--     groups %>% -->
<!--     unlist %>%  -->
<!--     as.character -->
<!--   random_grp <- grouped_df %>%  -->
<!--     summarise() %>%  -->
<!--     sample_n(size, replace, weight) %>%  -->
<!--     mutate(unique_id = 1:NROW(.)) -->
<!--   grouped_df %>%  -->
<!--     right_join(random_grp, by=grp_var) %>%  -->
<!--     group_by_(grp_var)  -->
<!-- } -->
<!-- ``` -->
<!-- If you run this chunk the function `sample_n_groups` appears in the right upper panel in RStudio. Now you can use this particular function in your current session. Don't worry, you don't have to understand everything from the code provided by others, but make sure that it behaves the way you expect it to. Since this function is based on `dplyr` commands you can use it within a pipe chain, e.g. pipe it into a ggplot. -->
<!-- ```{r warning=FALSE, message=FALSE, echo=TRUE} -->
<!-- set.seed(42+42) -->
<!-- soep %>%  -->
<!--   group_by(id) %>%  -->
<!--   sample_n_groups(3) %>% # select all given observations across time for 5 people  -->
<!--   ggplot(aes(x = year, y = health_org, group=as_factor(id), color=as_factor(id))) +   -->
<!--   geom_line() + geom_point() + -->
<!--   labs(title="Health Status per Person",  -->
<!--        x="Year", y="Health Status", color="Person") +  -->
<!--   ylim(1,5)  -->
<!-- ``` -->
<!-- This is test data from the practice data set. It might be helpful to understand what people we selected to compare our code results. Working with real questionnaire data, next show personal information. If you really need a graph like this, drop the legend.  -->
<!-- ::: {.infobox2 .caution data-latex="warning"} -->
<!-- Never show person IDs in a report.  -->
<!-- ::: -->
<!-- #### Minimum Observations per Group  -->
<!-- <!-- https://stackoverflow.com/questions/32565050/r-random-sampling-a-minimum-number-of-observations-from-a-category -->
<p>–&gt;
<!-- <!-- library(data.table) --> –&gt;
<!-- <!-- setDT(df)[,.SD[sample(.N, sample(min(5,.N):min(.N,14),1))], by=id] --> –&gt;</p>
<!-- The full potential of panel data is to track people over time. We can literally follow people from graduation, to their first job, marriage, first child and buying yourself a house. But we hardly see that from the previous plot for all people. We select **randomly 3 people who are observed at least 3 times** and plot their life satisfaction over time in a line plot (again, there are several options).  -->
<!-- ```{r warning=FALSE, message=FALSE, echo=F, eval=F} -->
<!-- set.seed(42) -->
<!-- soep %>%  -->
<!--   group_by(id) %>% -->
<!--   nest() %>%  -->
<!--   filter(purrr::map_lgl(data, ~ nrow(.x) >= 3)) %>% -->
<!--   unnest() %>% -->
<!--   sample_n_groups(5) %>% # select all given observations across time for 3 people  -->
<!--   ggplot(aes(x = year, y = satisf_org, col=factor(id))) +  -->
<!--   geom_line() + geom_point() + # add points connected by lines -->
<!--   labs(title="Life Satisfaction over Time by Person",  -->
<!--        subtitle="Random Sample of 5 People with at least 3 observations.", -->
<!--        x="Year", y="Life Satisfaction", colour="Person") + # give some illustrative labels -->
<!--   ylim(0,10) # limit the scale always to all possible values, to prevent random misperceptions  -->
<!-- ``` -->
<!-- ```{r warning=FALSE, message=FALSE, echo=TRUE} -->
<!-- set.seed(42+42) -->
<!-- soep %>% -->
<!--   group_by(id) %>% -->
<!--   filter(n()>=3) %>%  # the moment we drop some data -->
<!--   sample_n_groups(3) %>% # select all given observations across time for 3 people -->
<!--   ggplot(aes(x = year, y = health_org, col=factor(id))) + -->
<!--   geom_line() + geom_point() + # add points connected by lines -->
<!--   labs(title="Health Status over Time by Person", -->
<!--        subtitle="Random Sample of 3 People with at least 3 observations.", -->
<!--        x="Year", y="Health Status", colour="Person") + # give some illustrative labels -->
<!--   ylim(1,5) # limit the scale always to all possible values, to prevent random misperceptions -->
<!-- ``` -->
<!-- <!-- ::: {.infobox2 .information data-latex="warning"} -->
<p>–&gt;
<!-- <!-- Note that this is meaningless practice data. **Do not show person id numbers in your analysis.** --> –&gt;
<!-- <!-- ::: --> –&gt;</p>
<!-- ## Within and Between Variation  -->
<!-- <!-- Now focus on **within and between variation**. -->
<p>–&gt;
<!-- <!-- https://cran.r-project.org/web/packages/gghighlight/vignettes/gghighlight.html --> –&gt;</p>
<!-- Here is a similar plot of life satisfaction for selected people. -->
<!-- ```{r warning=FALSE, message=FALSE, echo=FALSE, eval=TRUE} -->
<!-- library(gghighlight) -->
<!-- set.seed(42) -->
<!-- highlights <- soep %>%  -->
<!--   group_by(id) %>% -->
<!--   nest() %>%  -->
<!--   filter(purrr::map_lgl(data, ~ nrow(.x) >= 3)) %>% -->
<!--   unnest() %>% -->
<!--   sample_n_groups(5)  -->
<!-- ``` -->
<!-- ```{r warning=FALSE, message=FALSE, echo=FALSE, eval=TRUE} -->
<!--   highlights %>% -->
<!--   ggplot(aes(x = year, y = satisf_org, col=factor(id))) +   -->
<!--   geom_line() + geom_point() +  -->
<!--   gghighlight(id %in% c(293973,317284), label_key = id) +  # label_key = id -->
<!--   #geom_point(aes(x=2000,y=10, size=10)) + -->
<!--   #geom_point(aes(x=2001,y=0, size=10)) + -->
<!--   labs(title="Life Satisfaction over Time by Person",  -->
<!--        subtitle="Highlighted with gghighlight.", -->
<!--        x="Year", y="Life  -->
<!--        Satisfaction", colour="Person") +  -->
<!--   ylim(0,10) + -->
<!--   theme(legend.position = "none") -->
<!--   #facet_wrap(~ id) -->
<!-- ``` -->
<!-- Person 293973 reports a dramatic change in satisfaction from one year to another. Starting from perfect happiness in 2000 (= 10), it drops to complete misery (= 0) and recovers immediately in 2002 (= 10). -->
<!-- <details> -->
<!-- <summary> -->
<!-- *Is person 293973 an outlier? Can you think of reasonable scenarios behind the data? * -->
<!-- </summary> -->
<!-- *Job's news*: take away all that a person holds dear, including children, health, and property. Because this is practice data and we cannot dig deeper into life events potentially triggering these changes. -->
<!-- </details> -->
<!-- <br>  -->
<!-- Look at the previous graph from this perspective:  -->
<!-- - **Within variation**: *Within* means per individual, group or unit over time.  -->
<!-- - **Between variation**: *Between* means comparing individuals, groups or units (both at a point in time or over time).  -->
<!-- In 2000 person 293973 and person 317284 both reported a happiness value of 10. In 2000, there is no **difference between** those two people. In 2001 though, 293973 experienced a critical shock and dropped to 0 while 317284 stayed at the very same value of 10. In 2001, the difference between both is 10.  -->
<!-- Compare the years 2000 and 2001 for person 293973. The value changes within that person by -10, whereas there is no change for person 317284. You often read about **changes** within people (across time) and about **differences** between them. In the line plot, **within changes** happens along the horizontal x-axis, whereas **between differences** can be measured as the vertical distance on the y-axis.  -->
<!-- **Between and within variation** are new properties of a panel data variable.  -->
<!-- <!-- The question What is the within variation of happiness.  -->
<p>–&gt;
<!-- <!-- **Sufficient within variation** is required to apply panel data estimations (later in the course). --> –&gt;</p>
<!-- ::: {.infobox2 .information data-latex="warning"} -->
<!-- To fully exploit panel data, we need **enough within variation**. -->
<!-- ::: -->
<!-- <details> -->
<!-- <summary> -->
<!-- *Is there enough within variation?* -->
<!-- </summary> -->
<!-- ```{r, echo=FALSE, out.width="80%", fig.cap="\\label{fig:within}Figure 2: Screenshot from a [lecture script of Brüderl and Ludwig.](https://www.ls3.soziologie.uni-muenchen.de/studium-lehre/archiv/teaching-marterials/panel-analysis_april-2019.pdf) The software is Stata.", fig.align='center'} -->
<!-- knitr::include_graphics("images/Within_Variation.png") -->
<!-- ``` -->
<!-- </details> -->
<!-- <!-- ### Minimal working example (6 pt) -->
<p>–&gt;
<!-- <!-- http://rizaudinsahlan.blogspot.com/2016/06/within-and-between-variation-in-panel.html --> –&gt;</p>
<!-- <!-- The following table shows between and within variation for a minimal panel data example. Three people are observed in three periods each (no missings). The panel data is **balanced** (all individuals are observed in all years, there are no gaps).  -->
<p>–&gt;</p>
<!-- <!-- ```{r warning=FALSE, message=FALSE, echo=FALSE, eval=FALSE} -->
<p>–&gt;
<!-- <!-- paneldata <- data.frame(id = rep(1:3, each=3), --> –&gt;
<!-- <!--                         time = rep(1:3, times=3), --> –&gt;
<!-- <!--                         x = c(9,10,11,20,20,20,25,30,35)) --> –&gt;
<!-- <!-- paneldata --> –&gt;
<!-- <!-- ``` --> –&gt;</p>
<!-- <!-- Please calculate all columns according to table 1 for the two individuals (id 293973 and 317284). All necessary formulas are provided in the table. Please create all these values by computation. Hint: You may need tidyverse verbs `filter`, `select`, `group_by`, `ungroup` and `mutate`. In a list of commands you can turn the group mode on and off. First you `group_by` your data, do the calculation, `ungroup` and do more calculations. Furthermore, I suggest the `gt` package in order to clean up the table design. Your result should look like this: -->
<p>–&gt;</p>
<!-- <!-- ```{r warning=FALSE, message=FALSE, echo=FALSE, eval=TRUE} -->
<p>–&gt;
<!-- <!-- library(gt) --> –&gt;</p>
<!-- <!-- library(sjlabelled) -->
<p>–&gt;
<!-- <!-- minipanel <- highlights %>% --> –&gt;
<!-- <!--   filter(id %in% c(293973,317284)) %>% --> –&gt;
<!-- <!--   remove_all_labels() --> –&gt;</p>
<!-- <!-- wb <- highlights %>% -->
<p>–&gt;
<!-- <!--   filter(id %in% c(293973,317284)) %>% --> –&gt;
<!-- <!--   select(id, year, satisf_org) %>% --> –&gt;
<!-- <!--   group_by(id) %>% --> –&gt;
<!-- <!--   mutate(Individual_Mean = round(mean(satisf_org),2)) %>% --> –&gt;
<!-- <!--   ungroup() %>% --> –&gt;
<!-- <!--   mutate(Overall_Mean = round(mean(satisf_org),2)) %>% --> –&gt;
<!-- <!--   mutate(Between = Individual_Mean - Overall_Mean) %>% --> –&gt;
<!-- <!--   group_by(id) %>% --> –&gt;
<!-- <!--   mutate(Within = satisf_org - Individual_Mean) %>% --> –&gt;
<!-- <!--   ungroup() %>% --> –&gt;
<!-- <!--   mutate(Within_alt = satisf_org - Individual_Mean + Overall_Mean) --> –&gt;</p>
<!-- <!--   wb %>% -->
<p>–&gt;
<!-- <!--   gt() %>%  --> –&gt;
<!-- <!--   tab_header( --> –&gt;
<!-- <!--     title = "Understanding between and within variation.") %>%  --> –&gt;
<!-- <!--   tab_options( --> –&gt;
<!-- <!--     heading.title.font.size = "small", --> –&gt;
<!-- <!--     heading.subtitle.font.size = "small", --> –&gt;
<!-- <!--     table.font.size = "small", --> –&gt;
<!-- <!--     data_row.padding = px(2)) --> –&gt;</p>
<!-- <!-- ``` -->
<p>–&gt;</p>
<!-- <!-- <br> -->
<p>–&gt;</p>
<!-- <!-- ```{r,  results='asis', echo=F} -->
<p>–&gt;
<!-- <!-- cat( --> –&gt;
<!-- <!--   '<pre class="r"> --> –&gt;
<!-- <!--   <code class = "hlsj"> <span class="hljs-string"> <br> <br> </span> </code> --> –&gt;
<!-- <!--   </pre> --> –&gt;
<!-- <!--   ') --> –&gt;
<!-- <!-- ``` --> –&gt;</p>
<!-- <!-- ::: {.infobox2 .information data-latex="warning"} -->
<p>–&gt;
<!-- <!-- A **minimal working example (MWE)** is useful to understand formulas or data manipulation and is often required in data science or programming discussion boards (such as stackoverflow or statalist.org) --> –&gt;
<!-- <!-- ::: --> –&gt;</p>
<!-- <!-- - <https://stackoverflow.com/help/minimal-reproducible-example> -->
<p>–&gt;
<!-- <!-- - <https://www.statalist.org/forums/help#stata> --> –&gt;</p>
<!-- ### XTSUM (from Stata) -->
<!-- In Stata there is a command **xtsum** which **calculates overall, between and within variation**. This is not implemented in any R package so far. Still, clever people created another personal function on Stack Overflow <https://stackoverflow.com/questions/49282083/xtsum-command-for-r>: -->
<!-- <details> -->
<!-- <summary> -->
<!-- *Show me the crazy xtsum code.* -->
<!-- </summary> -->
<!-- ```{r echo = TRUE, eval=TRUE, warning=FALSE, message=FALSE} -->
<!-- # Again, copy the code and run it, and you can use it in your R session.  -->
<!-- library(rlang) -->
<!-- XTSUM <- function(data, varname, unit) { -->
<!--   varname <- enquo(varname) -->
<!--   loc.unit <- enquo(unit) -->
<!-- ores <- data %>% summarise(ovr.mean=mean(!! varname, na.rm=TRUE), ovr.sd=sd(!! varname, na.rm=TRUE), ovr.min = min(!! varname, na.rm=TRUE), ovr.max=max(!! varname, na.rm=TRUE), ovr.N=sum(as.numeric((!is.na(!! varname))))) -->
<!-- bmeans <- data %>% group_by(!! loc.unit) %>% summarise(meanx=mean(!! varname, na.rm=T), t.count=sum(as.numeric(!is.na(!! varname)))) -->
<!-- bres <- bmeans %>% ungroup() %>% summarise(between.sd = sd(meanx, na.rm=TRUE), between.min = min(meanx, na.rm=TRUE), between.max=max(meanx, na.rm=TRUE), Units=sum(as.numeric(!is.na(t.count))), t.bar=mean(t.count, na.rm=TRUE)) -->
<!-- wdat <- data %>% group_by(!! loc.unit) %>% mutate(W.x = scale(!! varname, scale=FALSE)) -->
<!-- wres <- wdat %>% ungroup() %>% summarise(within.sd=sd(W.x, na.rm=TRUE), within.min=min(W.x, na.rm=TRUE), within.max=max(W.x, na.rm=TRUE)) -->
<!-- return(list(ores=ores,bres=bres,wres=wres)) -->
<!-- } -->
<!-- ``` -->
<!-- </details> -->
<!-- We can use this functionality to compare our prior results.  -->
<!-- ```{r warning=FALSE, message=FALSE, echo=TRUE} -->
<!-- library(sjlabelled) -->
<!-- minipanel <- soep %>% -->
<!--   filter(id %in% c(293973,317284)) %>% -->
<!--   remove_all_labels() -->
<!-- XTSUM(minipanel, varname=satisf_org, unit=id) -->
<!-- ``` -->
<!-- <!-- Understanding xtsum output -->
<p>–&gt;
<!-- <!-- http://stephenporter.org/files/xtsum_handout.pdf --> –&gt;</p>
<!-- `XTSUM` tells us some more results. The overall mean is 8.62 as expected. The overall smallest value of satisfaction is 0, the highest is 10. We saw this in the graph. We have *N=8* observations or rows. But we only have *n=2* units (see the medium panel). Units (people) are observed on average for `t.bar = 4` periods (one person 3 years, one person 5 years, makes 4 years on average).  -->
<!-- Standard deviation `sd` is at the core of **within and between variation** (since it is a measure of dispersion or variation). In the previous graph, we focused on **within changes** and **between differences**.  -->
<!-- <!-- We don't compare or interpret the quantity of variation at this point.  -->
<p>–&gt;</p>
<!-- <!-- # ```{r echo = TRUE, eval=TRUE} -->
<p>–&gt;
<!-- <!-- # sd(c(6.67,9.80)) --> –&gt;
<!-- <!-- # ``` --> –&gt;</p>
<!-- ::: {.infobox2 .information data-latex="warning"} -->
<!-- Think about examples (i.e. variables) that you expect to not have within variation. -->
<!-- ::: -->
<!-- <!-- Wait. Why should there be no within variation for a variable? There are plenty reasons! Think about gender. In the SOEP data gender is never changing (interesting questions about gender identity or transgender cannot be analyzed with SOEP).  -->
<p>–&gt;</p>
<!-- Run `XTSUM()` on different variables to test your knowledge.  -->

</div>
</div>
</div>
</div>
<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://https-marcokuehne-github-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="mean-comparison.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="text-mining.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Becoming Fluent In Data.pdf", "Becoming Fluent In Data.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": false
},
"toc_depth": 1,
"toc-title": "Table of Contents",
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
